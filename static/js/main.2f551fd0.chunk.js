(this["webpackJsonpkcal-counter"]=this["webpackJsonpkcal-counter"]||[]).push([[0],{181:function(e,t,n){},332:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(13),o=n.n(r),i=(n(181),n(78)),s=n(16),l=n(12),j=n(21),u=n(383),d=n(370),b=n(39),O="http://sipv.gorecan.com:11111/api/v1",m=n(58),h=n.n(m),x=n(157);var f=n(3),g=c.a.createContext({publicFood:[],loadFood:function(){}});function p(){return Object(a.useContext)(g)}var v=function(e){var t=e.children,n=Object(a.useState)([]),c=Object(l.a)(n,2),r=c[0],o=c[1],i=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),o=Object(l.a)(r,2);return{loading:n,error:o[0],setLoading:c,setError:o[1]}}(),s=(i.loading,i.error,i.setLoading),j=i.setError;var u={publicFood:r,loadFood:function(e){s(!0),h()({method:"get",url:"".concat(O,"/foods/public"),headers:{Authorization:"Bearer ".concat(e.token)}}).then((function(e){o(e.data),console.log(e.data)})).catch((function(e){return j(e.message)})).then((function(){return s(!1)}))}};return Object(f.jsx)(g.Provider,{value:u,children:t})},y={username:"",name:"",id:"",permissions:[],token:""},k=c.a.createContext({isAuthenticated:null,currentUser:y,loading:!1,error:"",register:function(){},login:function(){},logout:function(){}});function C(){return Object(a.useContext)(k)}var S=function(e){var t=e.children,n=Object(a.useState)(y),c=Object(l.a)(n,2),r=c[0],o=c[1],i=Object(a.useState)(null),s=Object(l.a)(i,2),j=s[0],u=s[1],d=Object(a.useState)(""),b=Object(l.a)(d,2),m=b[0],g=b[1],v=Object(a.useState)(!1),C=Object(l.a)(v,2),S=C[0],w=C[1],T=p().loadFood;function N(){var e=localStorage.getItem("token");e&&function(e){return!((new Date).getTime()/1e3>parseInt(Object(x.a)(e).exp))}(e)?function(e){w(!0),h()({method:"get",url:"".concat(O,"/profile"),headers:{Authorization:"Bearer ".concat(e)}}).then((function(t){var n=t.data,a=n.firstName,c=n.lastName,r=n.id,i=n.permissions,s=n.username;o({id:r,name:a+" "+c,username:s,permissions:i,token:e}),u(!0)})).catch((function(e){g(e),u(!1)})).then((function(){w(!1)}))}(e):u(!1)}Object(a.useEffect)((function(){N()}),[]),Object(a.useEffect)((function(){j&&T(r)}),[j]);var F={isAuthenticated:j,currentUser:r,loading:S,error:m,register:function(e){w(!0),h()({method:"post",url:"".concat(O,"/register"),data:e}).then((function(e){console.log(e)})).catch((function(e){return g(e.response.data.message)})).then((function(){return w(!1)}))},login:function(e){w(!0),h()({method:"post",url:"".concat(O,"/authenticate"),data:e}).then((function(e){var t=e.data,n=t.id,a=t.name,c=t.permissions,r=t.token,i=t.username;console.log(r),localStorage.setItem("token",r),o({id:n,name:a,permissions:c,token:r,username:i}),u(!0)})).catch((function(e){e.response?g(e.response.data.message):g("Unknown error occurred!"),u(!1)})).then((function(){w(!1)}))},logout:function(){w(!0),h()({method:"delete",url:"".concat(O,"/session/destroy"),headers:{Authorization:"Bearer ".concat(r.token)}}).catch((function(e){return g(e)})).then((function(){localStorage.removeItem("token"),u(!1),w(!1)}))}};return Object(f.jsx)(k.Provider,{value:F,children:t})},w=n(23),T=n(90),N=n(369),F=n(88),P=function(e){var t=e.loading,n=Object(T.a)(e,["loading"]);return Object(f.jsx)(N.a,Object(w.a)(Object(w.a)({},n),{},{children:t?Object(f.jsx)(F.PulseLoader,{size:"8px",color:"white"}):n.children}))},A=n(26),B=A.a().shape({username:A.c().required(),password:A.c().required()}),E=function(e){var t=e.toggleAction,n=C(),a=n.login,c=n.loading,r=n.isAuthenticated;n.error;return r?Object(f.jsx)(s.a,{to:"/dashboard"}):Object(f.jsx)(j.c,{initialValues:{username:"",password:""},validationSchema:B,onSubmit:function(e,t){var n=t.setSubmitting;a(e),n(!1)},children:function(e){var n=e.submitForm,a=e.isSubmitting,r=e.errors;return Object(f.jsxs)(j.b,{children:[console.log(r.username),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"username",type:"text",label:"Username",component:b.a,error:r.username})}),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"password",type:"password",label:"Password",component:b.a})}),Object(f.jsxs)(u.a,{margin:1,children:[Object(f.jsx)(P,{loading:c,variant:"contained",color:"primary",disabled:a,onClick:n,children:"Login"}),Object(f.jsx)(d.a,{component:"button",type:"button",variant:"body1",onClick:t,children:"Create an account"})]})]})}})},I=A.a().shape({firstName:A.c().min(2,"Too short!").max(50,"Too long!").required(),lastName:A.c().min(2,"Too short!").max(50,"Too long!").required(),username:A.c().min(5,"Too short!").max(50,"Too long!").required(),email:A.c().email("Invalid email").required(),password:A.c().min(12,"Too short!").max(100,"Too long!").required(),confirmPassword:A.c().oneOf([A.b("password"),null],"Passwords must match").required()}),L=function(e){var t=e.toggleAction,n=C(),a=n.register,c=n.loading;n.error;return Object(f.jsx)(j.c,{initialValues:{firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:""},validationSchema:I,onSubmit:function(e,t){var n=t.setSubmitting;a({firstName:e.firstName,lastName:e.lastName,username:e.username,email:e.email,password:e.password}),n(!1)},children:function(e){var n=e.submitForm,a=e.isSubmitting;return Object(f.jsxs)(j.b,{children:[Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"firstName",type:"text",label:"First Name",component:b.a})}),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"lastName",type:"text",label:"Last Name",component:b.a})}),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"username",type:"text",label:"Username",component:b.a})}),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"email",type:"email",label:"Email",component:b.a})}),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"password",type:"password",label:"Password",component:b.a})}),Object(f.jsx)(u.a,{margin:1,children:Object(f.jsx)(j.a,{name:"confirmPassword",type:"password",label:"Confirm Password",component:b.a})}),Object(f.jsxs)(u.a,{margin:1,children:[Object(f.jsx)(P,{loading:c,variant:"contained",color:"primary",disabled:a,onClick:n,children:"Register"}),Object(f.jsx)(d.a,{component:"button",type:"button",variant:"body1",onClick:t,children:"I already have an account"})]})]})}})},U=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1];function r(){c((function(e){return!e}))}return Object(f.jsx)("div",{children:n?Object(f.jsx)(L,{toggleAction:r}):Object(f.jsx)(E,{toggleAction:r})})},q=n(70),M=n(364),R=n(384),V=function(e){var t=e.carbs,n=e.fat,a=e.protein;return Object(f.jsxs)("div",{children:[Object(f.jsx)(R.a,{variant:"outlined",color:"primary",label:"Carbs: ".concat(t,"g")}),Object(f.jsx)(R.a,{variant:"outlined",color:"primary",label:"Fat: ".concat(n,"g")}),Object(f.jsx)(R.a,{variant:"outlined",color:"primary",label:"Protein: ".concat(a,"g")})]})},z=n(371),D=n(372),G=n(385),H=Object(z.a)({root:{width:250},input:{width:42}}),J=function(e){var t=e.value,n=e.setValue,a=e.label,c=H();return Object(f.jsxs)("div",{className:c.root,children:[Object(f.jsx)(q.a,{id:"input-slider",gutterBottom:!0,children:a}),Object(f.jsxs)(D.a,{container:!0,spacing:2,alignItems:"center",children:[Object(f.jsx)(D.a,{item:!0,xs:!0,children:Object(f.jsx)(G.a,{value:"number"===typeof t?t:0,onChange:function(e,t){n(t)},"aria-labelledby":"input-slider"})}),Object(f.jsxs)(D.a,{item:!0,children:[Object(f.jsx)(M.a,{className:c.input,value:t,margin:"dense",onChange:function(e){n(""===e.target.value?"":Number(e.target.value))},onBlur:function(){(t<0||""===t)&&n(0)},inputProps:{step:1,min:0,max:100,type:"number","aria-labelledby":"input-slider"}}),"%"]})]})]})},K=function(){var e=Object(a.useState)(50),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(15),o=Object(l.a)(r,2),i=o[0],s=o[1],j=Object(a.useState)(35),u=Object(l.a)(j,2),d=u[0],b=u[1],O=Object(a.useState)(2e3),m=Object(l.a)(O,2),h=m[0],x=m[1],g=Object(a.useState)(!1),p=Object(l.a)(g,2),v=p[0],y=p[1],k=Object(a.useState)({carbs:0,fat:0,protein:0}),C=Object(l.a)(k,2),S=C[0],T=C[1];return Object(a.useEffect)((function(){!function(){if("number"===typeof h){var e=0;"number"===typeof n&&(e+=n,T((function(e){return Object(w.a)(Object(w.a)({},e),{},{carbs:Math.round(h/400*n)})}))),"number"===typeof i&&(e+=i,T((function(e){return Object(w.a)(Object(w.a)({},e),{},{fat:Math.round(h/900*i)})}))),"number"===typeof d&&(e+=d,T((function(e){return Object(w.a)(Object(w.a)({},e),{},{protein:Math.round(h/400*d)})}))),y(e>100)}}()}),[n,i,d,h]),Object(f.jsxs)("div",{children:[Object(f.jsx)(q.a,{id:"total-calories",gutterBottom:!0,children:"Total calories"}),Object(f.jsx)(M.a,{"aria-labelledby":"total-calories",value:h,onChange:function(e){x(""===e.target.value?"":Number(e.target.value))},onBlur:function(){(h<0||""===h)&&x(0)}}),Object(f.jsx)(J,{label:"Carbohydrates",value:n,setValue:c}),Object(f.jsx)(J,{label:"Protein",value:d,setValue:b}),Object(f.jsx)(J,{label:"Fat",value:i,setValue:s}),Object(f.jsx)(V,Object(w.a)({},S)),v&&Object(f.jsx)("div",{children:"The percentage total is more than 100%"})]})},W=function(){return Object(f.jsx)("div",{children:Object(f.jsx)(K,{})})},Y=function(){var e=C().currentUser;return Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:"Profile page"}),Object(f.jsx)("div",{children:e.id}),Object(f.jsx)("div",{children:e.name}),Object(f.jsx)("div",{children:e.username}),Object(f.jsx)("div",{children:e.token})]})},Q=function(e){var t=e.children,n=Object(T.a)(e,["children"]),a=C().isAuthenticated;return Object(f.jsx)(s.b,Object(w.a)(Object(w.a)({},n),{},{render:function(){return a?t:Object(f.jsx)(s.a,{to:{pathname:"/"}})}}))},X=n(373),Z=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1];return{darkMode:n,toggleDarkMode:function(){c((function(e){return!e}))}}},$=n(164),_=Object($.a)({palette:{type:"light"}}),ee=Object($.a)({palette:{type:"dark"}}),te=c.a.createContext((function(){}));var ne=function(e){var t=e.children,n=Z(),a=n.darkMode,c=n.toggleDarkMode;return Object(f.jsx)(X.a,{theme:a?ee:_,children:Object(f.jsx)(te.Provider,{value:c,children:t})})},ae=n(49),ce=n(374),re=n(375),oe=n(336),ie=n(368),se=n(161),le=n.n(se),je=n(162),ue=n.n(je),de=Object(z.a)((function(e){return{menuButton:{marginRight:e.spacing(2),edge:"start",color:"inherit"},title:{marginRight:20},filler:{flexGrow:1},icon:{width:40,height:40},switchToggle:{color:"default"}}})),be=function(e){var t=e.loading,n=e.logout,a=e.toggleTheme,c=e.type,r=e.handleLogoClick,o=e.handleProfileClick,i=e.handleFoodClick,s=de();return Object(f.jsx)(ce.a,{position:"static",children:Object(f.jsxs)(re.a,{children:[Object(f.jsx)(oe.a,{className:s.menuButton,onClick:r,children:Object(f.jsx)(le.a,{})}),Object(f.jsx)(q.a,{className:s.title,variant:"h6",children:"KCAL-COUNTER"}),Object(f.jsx)(N.a,{variant:"text",color:"inherit",onClick:i,children:"Food"}),Object(f.jsx)("div",{className:s.filler}),Object(f.jsx)(ie.a,{className:s.switchToggle,checked:"light"===c,onChange:a}),Object(f.jsx)(oe.a,{className:s.menuButton,onClick:o,children:Object(f.jsx)(ue.a,{className:s.icon})}),Object(f.jsx)(P,{loading:t,variant:"outlined",color:"inherit",onClick:n,children:"Logout"})]})})},Oe=function(){var e=Object(s.g)(),t=C(),n=t.logout,c=t.loading,r=Object(a.useContext)(te),o=Object(ae.a)().palette.type;return Object(f.jsx)(be,{loading:c,logout:n,handleLogoClick:function(){e.push("/")},handleProfileClick:function(){e.push("/profile")},handleFoodClick:function(){e.push("/food")},toggleTheme:r,type:o})},me=n(386),he=n(378),xe=n(379),fe=n(380),ge=n(376),pe=n(377),ve=n(44),ye=n(163),ke=function(e){switch(e.foodType){case"MEATS":return Object(f.jsx)(ve.d,{});case"FRUITS":return Object(f.jsx)(ve.f,{});case"VEGETABLES":return Object(f.jsx)(ve.b,{});case"FISH":return Object(f.jsx)(ve.c,{});case"NUTS":return Object(f.jsx)(ve.e,{});case"PASTRY":return Object(f.jsx)(ve.a,{});case"SWEETS":return Object(f.jsx)(ve.h,{});case"CARB":return Object(f.jsx)(ve.g,{});default:return Object(f.jsx)(ye.a,{})}},Ce=function(e){var t=e.foodType;return Object(f.jsx)(ge.a,{children:Object(f.jsx)(pe.a,{fontSize:"large",color:"primary",children:Object(f.jsx)(ke,{foodType:t})})})},Se=Object(z.a)((function(e){return Object(me.a)({listItem:{backgroundColor:e.palette.background.paper},kcal:{margin:e.spacing(4,0,2)}})})),we=function(e){var t=e.food,n=Se();return Object(f.jsxs)(he.a,{className:n.listItem,children:[Object(f.jsx)(Ce,{foodType:t.foodType}),Object(f.jsx)(xe.a,{primary:t.name,secondary:t.foodType}),Object(f.jsx)(fe.a,{children:Object(f.jsx)(q.a,{variant:"h6",children:"".concat(t.kcal," kcal")})})]})},Te=n(367),Ne=n(381),Fe=function(e){var t=e.foodArray;return Object(f.jsx)(Te.a,{children:t.map((function(e,n){return Object(f.jsxs)("div",{children:[Object(f.jsx)(we,{food:e}),n!==t.length-1?Object(f.jsx)(Ne.a,{variant:"inset"}):Object(f.jsx)(f.Fragment,{})]},e.id)}))})},Pe=function(){var e=p().publicFood;return Object(f.jsx)("div",{children:Object(f.jsx)(Fe,{foodArray:e})})},Ae=function(){return Object(f.jsx)("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(f.jsx)(F.RotateLoader,{loading:!0})})};var Be=function(){return null===C().isAuthenticated?Object(f.jsx)(Ae,{}):Object(f.jsx)(i.a,{basename:"/kcal-counter",children:Object(f.jsxs)(s.d,{children:[Object(f.jsx)(s.b,{path:"/",exact:!0,component:U}),Object(f.jsxs)(Q,{path:"/dashboard",children:[Object(f.jsx)(Oe,{}),Object(f.jsx)(W,{})]}),Object(f.jsxs)(Q,{path:"/profile",children:[Object(f.jsx)(Oe,{}),Object(f.jsx)(Y,{})]}),Object(f.jsxs)(Q,{path:"/food",children:[Object(f.jsx)(Oe,{}),Object(f.jsx)(Pe,{})]})]})})},Ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,388)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))},Ie=n(382);o.a.render(Object(f.jsx)(ne,{children:Object(f.jsx)(v,{children:Object(f.jsxs)(S,{children:[Object(f.jsx)(Ie.a,{}),Object(f.jsx)(Be,{})]})})}),document.getElementById("root")),Ee()}},[[332,1,2]]]);
//# sourceMappingURL=main.2f551fd0.chunk.js.map